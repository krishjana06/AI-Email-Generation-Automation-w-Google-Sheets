<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 16px; background-color: #f5f5f5; }
    h2 { margin-top: 0; color: #333; }
    .form-group { margin-bottom: 12px; }
    label { display: block; font-weight: bold; margin-bottom: 4px; color: #555; }
    select, input[type="range"] {
      width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;
      box-sizing: border-box;
    }
    input[type="range"] { height: 30px; }
    button {
      display: block; width: 100%; background-color: #000; color: #fff;
      border: none; border-radius: 4px; padding: 10px; font-size: 14px;
      cursor: pointer; font-weight: bold;
    }
    button:hover { background-color: #808080; }
    #output {
      margin-top: 16px; max-height: 200px; overflow-y: auto;
      padding: 8px; background-color: #fff; border: 1px solid #ddd; border-radius: 4px;
    }
    ul { list-style: none; padding: 0; margin: 0; }
    li { margin-bottom: 6px; color: #333; }
    li:before { content: "• "; color: #1a73e8; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Auto-Email Generator</h2>
  <div class="form-group">
    <label for="variant">Template Variant</label>
    <select id="variant">
      <option value="default">Default</option>
      <!-- Add more variants here -->
    </select>
  </div>
  <div class="form-group">
    <label for="tone">Tone Level: <span id="tone-value">3</span></label>
    <input type="range" id="tone" min="1" max="5" value="3" oninput="updateToneValue(this.value)">
  </div>
  <button onclick="runGenerate()">Generate Drafts</button>
  <div id="output"></div>

  <script>
    function updateToneValue(val) {
      document.getElementById('tone-value').innerText = val;
    }
    function runGenerate() {
      document.getElementById('output').innerText = 'Processing…';
      var variant = document.getElementById('variant').value;
      var tone = document.getElementById('tone').value;
      google.script.run
        .withSuccessHandler(displayResults)
        .generateDrafts(variant, tone);
    }
    function displayResults(results) {
      var html = '<ul>';
      results.forEach(function(r) {
        if (r.success) {
          html += '<li>Row ' + r.row + ': ✓</li>';
        } else {
          html += '<li>Row ' + r.row + ': ' + r.error + '</li>';
        }
      });
      html += '</ul>';
      document.getElementById('output').innerHTML = html;
    }
  </script>
</body>
</html>
